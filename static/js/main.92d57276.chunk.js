(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{137:function(e,n,t){e.exports=t.p+"static/media/d4.47a22d03.svg"},138:function(e,n,t){e.exports=t.p+"static/media/perspective-dice-six.d746d684.svg"},139:function(e,n,t){e.exports=t.p+"static/media/dice-eight-faces-eight.6e85915b.svg"},140:function(e,n,t){e.exports=t.p+"static/media/d12.bfe5934e.svg"},141:function(e,n,t){e.exports=t.p+"static/media/dice-twenty-faces-twenty.aeb518c5.svg"},142:function(e,n,t){e.exports=t.p+"static/media/rolling-dices.79d6d7d5.svg"},164:function(e,n,t){e.exports=t(303)},169:function(e,n,t){},302:function(e,n,t){},303:function(e,n,t){"use strict";t.r(n);var a=t(1),i=t.n(a),r=t(27),o=t.n(r),c=(t(169),t(33)),u=t(39),l=t(9),s=t(10),m=t(18),d=t(17),h=t(28),f=t(19),v=t(20),b=function(){function e(n){var t=n.dieType,a=n.explodeThreshold,i=n.name,r=n.image;Object(l.a)(this,e),this.dieType=t,this.name=i,this.image=r,this.explodeThreshold=a,this.clone=this.clone.bind(this),this.roll=this.roll.bind(this),this.countFaces=this.countFaces.bind(this),this.getNumFaces=this.getNumFaces.bind(this)}return Object(s.a)(e,[{key:"clone",value:function(){return new e({dieType:this.dieType,explodeThreshold:this.explodeThreshold,name:this.name,image:this.image})}},{key:"roll",value:function(){return new Error("Not implemented")}},{key:"countFaces",value:function(){return new Error("Not implemented")}},{key:"getNumFaces",value:function(){return Array.from(this.countFaces().values()).reduce(function(e,n){return e+n},0)}}]),e}();function p(e,n){return null===e||void 0===e?n:e}var y=function(){function e(n){var t=n.primaryValue,a=n.secondaryValues,i=n.name;Object(l.a)(this,e),this.primaryValue=p(t,[]),this.secondaryValues=p(a,[]),this.name=void 0===i&&void 0!==t?t.toString():i,this.clone=this.clone.bind(this)}return Object(s.a)(e,[{key:"clone",value:function(){return new e({primaryValue:this.primaryValue,secondaryValues:this.secondaryValues.map(function(e){return e.clone()}),name:this.name})}}]),e}(),O=function(){function e(n){var t=n.dieFace,a=n.count;Object(l.a)(this,e),this.dieFace=t,this.count=a,this.clone=this.clone.bind(this)}return Object(s.a)(e,[{key:"clone",value:function(){return new e({dieFace:this.dieFace.clone(),count:this.count})}}]),e}();function g(e,n){return Math.floor(Math.random(n-e+1))+e}var C=t(136),w=t.n(C),E=t(137),j=t.n(E),P=t(138),D=t.n(P),k=t(139),S=t.n(k),x=t(94),V=t.n(x),T=t(140),N=t.n(T),F=t(141),M=t.n(F),A=t(142),R=t.n(A),_=function(e){function n(e){var t;Object(l.a)(this,n),t=Object(m.a)(this,Object(d.a)(n).call(this,Object(v.a)({dieType:"numeric"},e)));var a=e.minValue,i=e.maxValue,r=e.numSides;if(r?(t.minValue=1,t.maxValue=r):(t.minValue=a,t.maxValue=i),void 0===e.name&&(t.name="d".concat(t.maxValue)),!t.image)switch(t.maxValue){case 4:t.image=j.a;break;case 6:t.image=D.a;break;case 8:t.image=S.a;break;case 10:case 100:t.image=V.a;break;case 12:t.image=N.a;break;case 20:t.image=M.a;break;default:t.image=R.a}return t}return Object(f.a)(n,e),Object(s.a)(n,[{key:"clone",value:function(){return new n({minValue:this.minValue,maxValue:this.maxValue,numSides:this.numSides,explodeThreshold:this.explodeThreshold,name:this.name})}},{key:"roll",value:function(){var e=g(this.minValue,this.maxValue);return new y({primaryValue:e})}},{key:"countFaces",value:function(){var e=new Map;return w.a.range(this.minValue,this.maxValue+1).forEach(function(n){var t=new y({primaryValue:n});e.has(t.name)?e.get(t.name).count++:e.set(t.name,new O({dieFace:t,count:1}))}),e}},{key:"getNumFaces",value:function(){return this.maxValue-this.minValue+1}}]),n}(b),I=function(e){function n(e){var t;Object(l.a)(this,n),t=Object(m.a)(this,Object(d.a)(n).call(this,e));var a=e.threshold;return t.threshold=a,t.clone=t.clone.bind(Object(h.a)(t)),t}return Object(f.a)(n,e),Object(s.a)(n,[{key:"clone",value:function(){return new n({minValue:this.minValue,maxValue:this.maxValue,numSides:this.numSides,explodeThreshold:this.explodeThreshold,name:this.name,threshold:this.threshold})}},{key:"roll",value:function(){var e=g(this.minValue,this.maxValue)>=this.threshold?1:0;return new y({primaryValue:e})}},{key:"enumerateFaces",value:function(){var e=new Map,n=this.maxValue-this.threshold+1,t=this.threshold-this.minValue,a=new y({primaryValue:1}),i=new y({primaryValue:0});return e.set(a.name,n),e.set(i.name,t),e}}]),n}(_),B=function(){function e(n){var t=n.name,a=n.count;Object(l.a)(this,e),this.name=t,this.count=a,this.clone=this.clone.bind(this)}return Object(s.a)(e,[{key:"clone",value:function(){return new e({name:this.name,count:this.count})}}]),e}(),L=function(){function e(n){var t=n.diceCounts,a=n.staticBonus,i=n.staticSecondaryBonuses,r=n.name;Object(l.a)(this,e),this.staticBonus=p(a,0),this.staticSecondaryBonuses=i,this.name=r,this.diceCounts=t.slice(),this.addDice=this.addDice.bind(this),this.removeDice=this.removeDice.bind(this),this.clone=this.clone.bind(this)}return Object(s.a)(e,[{key:"addDice",value:function(e,n){n=p(n,1);var t=this.diceCounts.find(function(n){return n.name===e.name}),a=(t?t.count:0)+n;t?t.count++:this.diceCounts.push(new B({name:e.name,count:a}))}},{key:"removeDice",value:function(e,n){var t=this.diceCounts.find(function(n){return n.name===e.name}),a=(t?t.count:0)-n;t?t.count=a:this.diceCounts.push(new B({name:e.name,count:a}))}},{key:"clone",value:function(){return new e({diceCounts:this.diceCounts.map(function(e){return e.clone()}),staticBonus:this.staticBonus,staticSecondaryBonuses:this.staticSecondaryBonuses,name:this.name})}}]),e}(),z=t(155),U=(t(175),"SET_STATISTICS"),q="RESET_STATISTICS";function J(){return function(e){var n=De.getState(),t=function(e,n){var t,a=e.diceCounts;if(0===a.length)throw new Error("Attempting to calculate probabilities with no dice");return a.filter(function(e){var t=e.count,a=e.name;return t>0&&n.has(a)}).reduce(function(e,t){var a=t.count,i=t.name,r=n.get(i);return e.concat(new Array(a).fill(r))},[]).forEach(function(e,n){var a=new Map,i=e.countFaces(),r=e.getNumFaces();if(0===n){var o=!0,c=!1,u=void 0;try{for(var l,s=i.values()[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){var m=l.value,d=m.count,h=m.dieFace.primaryValue;a.set(h,d/r),0}}catch(N){c=!0,u=N}finally{try{o||null==s.return||s.return()}finally{if(c)throw u}}}else{var f=!0,v=!1,b=void 0;try{for(var p,y=t.entries()[Symbol.iterator]();!(f=(p=y.next()).done);f=!0){var O=p.value,g=Object(z.a)(O,2),C=g[0],w=g[1],E=!0,j=!1,P=void 0;try{for(var D,k=i.values()[Symbol.iterator]();!(E=(D=k.next()).done);E=!0){var S=D.value;d=S.count,h=S.dieFace.primaryValue,0;var x=C+h,V=w*(d/r),T=a.get(x)||0;a.set(x,T+V)}}catch(N){j=!0,P=N}finally{try{E||null==k.return||k.return()}finally{if(j)throw P}}}}catch(N){v=!0,b=N}finally{try{f||null==y.return||y.return()}finally{if(v)throw b}}}t=a}),t}(n.dicePoolStore.currentDicePool,n.diceDefinitionStore.definitions);if(void 0!==t){var a=Array.from(t.keys()).sort(function(e,n){return e<n?-1:e>n?1:0}).reverse(),i=new Map;return a.reduce(function(e,n){var a=t.get(n)+e;return i.set(n,a),a},0),e(function(e,n){return{type:U,probabilities:e,cumulativeProbabilities:n}}(t,i))}}}var W="ADD_DIE_TO_POOL",Y="REMOVE_DIE_FROM_POOL",$="SAVE_CURRENT_POOL",G="CLEAR_COUNTS",H="SET_CURRENT_POOL";function K(){var e=function(){var e=new Map;return e=new Map([].concat(Object(u.a)(e),Object(u.a)(function(){var e=new Map,n=new I({name:"ArkhamDie",numSides:6,threshold:5});e.set(n.name,n);var t=new I({name:"ArkhamCurseDie",numSides:6,threshold:6});e.set(t.name,t);var a=new I({name:"ArkhamBlessDie",numSides:6,threshold:4});return e.set(a.name,a),e}()))),e=new Map([].concat(Object(u.a)(e),Object(u.a)(function(){var e=new Map;return[4,6,8,10,12,20,100].forEach(function(n){var t=new _({numSides:n});e.set(t.name,t)}),e}())))}(),n=new Map,t=function(){var e=[4,6,8,10,12,20].map(function(e){return new B({count:0,name:"d".concat(e)})});return new L({diceCounts:e,name:"D&D"})}();n.set(t.name,t);var a=function(e){var n=Array.from(e.values()).filter(function(e){return e.name.includes("Arkham")}).map(function(e){return new B({count:0,name:"d".concat(e)})});return new L({diceCounts:n,name:"Arkham"})}(e);n.set(a.name,a);var i=t.clone();return i.name="preset_1",n.set(i.name,i),{diceDefinitions:e,dicePools:n,currentName:t.name}}function Q(e,n){return function(t){return Promise.resolve(t(function(e,n){return{type:W,definition:e,count:n}}(e,n))).then(function(){t(J())})}}function X(e){return function(n){return Promise.resolve(n(function(e){return{type:$,newPoolName:e}}(e)))}}function Z(e){return function(n){return Promise.resolve(n(function(e){return{type:H,poolName:e}}(e))).then(function(){n(J())})}}function ee(){return function(e){return Promise.resolve(e({type:G}))}}function ne(e,n){return function(t){return Promise.resolve(t(function(e,n){return{type:Y,definition:e,count:n}}(e,Math.abs(n)))).then(function(){t(J())})}}var te=t(308),ae=(t(48),t(154)),ie=t(66),re=t(45),oe=function(e){function n(){return Object(l.a)(this,n),Object(m.a)(this,Object(d.a)(n).apply(this,arguments))}return Object(f.a)(n,e),Object(s.a)(n,[{key:"render",value:function(){var e=this.props,n=e.onChange,t=e.value,a=e.min,r=e.max;return i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement(re.a,{style:{display:"inline-block"},size:"small",name:"minus",onClick:function(){t>a&&n(t-1)}}),i.a.createElement(ie.a,{style:{display:"inline-block"},size:"small",type:"text",className:"number"},t),i.a.createElement(re.a,{style:{display:"inline-block"},size:"small",name:"plus",onClick:function(){t<r&&n(t+1)}}))}}]),n}(a.Component),ce=function(e){function n(){return Object(l.a)(this,n),Object(m.a)(this,Object(d.a)(n).apply(this,arguments))}return Object(f.a)(n,e),Object(s.a)(n,[{key:"render",value:function(){var e=this.props,n=e.image,t=e.count,a=e.name,r=e.onChangeCount;return n?i.a.createElement(i.a.Fragment,null,i.a.createElement(ae.a,{src:n,onClick:function(){r(t+1)}}),i.a.createElement("br",null),i.a.createElement(oe,{min:0,max:12,value:t,onChange:r}),i.a.createElement("br",null),i.a.createElement("br",null)):i.a.createElement(i.a.Fragment,null,i.a.createElement(ie.a,{onClick:function(){r(t+1)}},a),i.a.createElement("br",null),i.a.createElement(oe,{min:0,max:12,value:t,onChange:r}),i.a.createElement("br",null),i.a.createElement("br",null))}}]),n}(a.Component),ue=t(306),le=function(e){function n(){var e;return Object(l.a)(this,n),(e=Object(m.a)(this,Object(d.a)(n).call(this))).getPresetName=e.getPresetName.bind(Object(h.a)(e)),e.isRowEnabled=e.isRowEnabled.bind(Object(h.a)(e)),e}return Object(f.a)(n,e),Object(s.a)(n,[{key:"getPresetName",value:function(e){return"preset_".concat(e+1)}},{key:"isRowEnabled",value:function(e){var n=this.getPresetName(e);return this.props.dicePools.has(n)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("button",{style:{width:"100%"},onClick:function(){e.props.onClearCounts()}},"Clear Counts"),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement(te.a,{columns:4,divided:!0,style:{height:100}},Object(u.a)(Array(4).keys()).map(function(n,t){var a=e.getPresetName(n),r=e.isRowEnabled(n);return i.a.createElement(te.a.Column,{key:t},i.a.createElement(te.a.Row,null,t+1),i.a.createElement(te.a.Row,null,i.a.createElement(ue.a,{onClick:function(){e.props.onSetDicePool(a)},disabled:!r},"Load")),i.a.createElement(te.a.Row,null,i.a.createElement(ue.a,{onClick:function(){e.props.onSaveDicePool(a)}},"Save")))})))}}]),n}(a.Component);var se=Object(c.b)(function(e){var n=e.dicePoolStore;return{dicePool:n.currentDicePool,currentDicePoolName:n.currentDicePoolName,dicePools:n.dicePools}},function(e){return{onSetDicePool:function(n){e(Z(n))},onSaveDicePool:function(n){e(X(n))},onClearCounts:function(){e(ee())}}})(le),me=function(e){function n(e){var t;return Object(l.a)(this,n),(t=Object(m.a)(this,Object(d.a)(n).call(this,e))).onChangeCount=t.onChangeCount.bind(Object(h.a)(t)),t}return Object(f.a)(n,e),Object(s.a)(n,[{key:"onChangeCount",value:function(e,n){console.log("TCL: DiceChooserComponent -> onChangeCount -> countChange",n),console.log("TCL: DiceChooserComponent -> onChangeCount -> name",e);var t=this.props,a=t.definitions,i=t.onChangeCount;i(a.get(e),n)}},{key:"render",value:function(){var e=this,n=this.props,t=n.dicePool,a=n.definitions,r=t.diceCounts,o=r.slice();return i.a.createElement(te.a,{columns:2,divided:!0,style:{height:60}},i.a.createElement(te.a.Column,{width:11},i.a.createElement(te.a,{columns:r.length,divided:!0,style:{height:40}},i.a.createElement(te.a.Row,null,o.map(function(n,t){var r=n.name,o=n.count,c=a.get(r).image;return i.a.createElement(te.a.Column,{key:"die".concat(t)},i.a.createElement(ce,{image:c,name:r,count:o,onChangeCount:function(n){e.onChangeCount(r,n-o)}}))})))),i.a.createElement(te.a.Column,{width:4},i.a.createElement(se,null)))}}]),n}(a.Component);var de=Object(c.b)(function(e){return{dicePool:e.dicePoolStore.currentDicePool,definitions:e.diceDefinitionStore.definitions}},function(e){return{onChangeCount:function(n,t){return t>=1?e(Q(n,t)):t<0?e(ne(n,t)):void 0}}})(me),he=t(35),fe=function(e){function n(){return Object(l.a)(this,n),Object(m.a)(this,Object(d.a)(n).call(this))}return Object(f.a)(n,e),Object(s.a)(n,[{key:"render",value:function(){var e=this.props,n=e.probabilities,t=e.cumulativeProbabilities,a="cumulative"===e.mode?t:n,r=Array.from(a.keys()).map(function(e){return e}),o=r.sort(function(e,n){return e<n?-1:1}).map(function(e){return{x:e,y:100*a.get(e)}}),c=r.sort(function(e,n){return e<n?-1:1}).map(function(e){var n=a.get(e);return{x:e,y:100*(n+.1),xOffset:20,label:"".concat((100*n).toFixed(1),"%")}});return i.a.createElement(i.a.Fragment,null,i.a.createElement(he.f,{yType:"linear",xType:"ordinal",height:200,width:800},i.a.createElement(he.b,{animation:!0,allowOffsetToBeReversed:!0,data:c}),i.a.createElement(he.e,{orientation:"bottom"}),i.a.createElement(he.g,null),i.a.createElement(he.a,null),i.a.createElement(he.d,null),i.a.createElement(he.c,{colorType:"literal",data:o})))}}]),n}(a.Component);var ve=Object(c.b)(function(e){var n=e.statisticsStore;return{isCalculationCurrent:n.isCalculationCurrent,probabilities:n.probabilities,cumulativeProbabilities:n.cumulativeProbabilities,mode:n.mode}},function(e){return{onRequestRecalculate:function(){return e(J())}}})(fe);t(302);var be=function(){return i.a.createElement("div",null,i.a.createElement(ve,null),i.a.createElement(de,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var pe=t(38),ye=function(){var e=K(),n=e.dicePools,t=e.currentName,a=n.get(t).clone();return{dicePools:n,currentDicePoolName:t,currentDicePool:a}};var Oe={isCalculationCurrent:!1,probabilities:new Map,cumulativeProbabilities:new Map,mode:"cumulative"};var ge="ADD_DEFINITION",Ce="MODIFY_DEFINITION",we="DELETE_DEFINITION",Ee=function(){return{definitions:K().diceDefinitions}};var je=Object(pe.c)({dicePoolStore:function(e,n){switch(void 0===e&&(e=ye()),n.type){case $:var t=n.newPoolName,a=e.currentDicePool.clone();a.name=t;var i=new Map(e.dicePools);return i.set(t,a),Object(v.a)({},e,{dicePools:i,currentDicePoolName:t,currentDicePool:a});case G:var r=e.currentDicePool.clone();return r.diceCounts=r.diceCounts.map(function(e){var n=e.clone();return n.count=0,n}),Object(v.a)({},e,{currentDicePool:r});case H:var o=n.poolName;if(console.log("TCL: reduceDieSets -> poolName",o),""===p(o,"")||!e.dicePools.has(o))return console.error("Could not find requested pool by name ".concat(o)),e;var c=e.dicePools.get(o).clone();return console.log("TCL: reduceDieSets -> updatedPool",c),Object(v.a)({},e,{currentDicePool:c,currentDicePoolName:o});case W:var u=e.currentDicePool.clone();return u.addDice(n.definition,n.count),Object(v.a)({},e,{currentDicePool:u});case Y:var l=e.currentDicePool.clone();return l.removeDice(n.definition,n.count),Object(v.a)({},e,{currentDicePool:l});default:return e}},diceDefinitionStore:function(e,n){switch(void 0===e&&(e=Ee()),n.type){case ge:case Ce:var t=new Map(e.definitions);return t.set(n.definition.name,n.definition),Object(v.a)({},e,{definitions:t});case we:var a=e.dicePool.clone();a.removeDice(n.definition,n.count);var i=new Map(e.dicePools);return i.set(e.currentDicePoolName,a),Object(v.a)({},e,{currentDicePool:a,dicePools:i});default:return e}},statisticsStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,n=arguments.length>1?arguments[1]:void 0,t=Object(v.a)({},e);switch(n.type){case U:t.probabilities=n.probabilities,t.cumulativeProbabilities=n.cumulativeProbabilities,t.isCalculationCurrent=!0;break;case q:t=Oe}return t}}),Pe=t(153);t.d(n,"store",function(){return De});var De=Object(pe.d)(je,Object(pe.a)(Pe.a));o.a.render(i.a.createElement(c.a,{store:De},i.a.createElement(be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},94:function(e,n,t){e.exports=t.p+"static/media/d10.0480ec4a.svg"}},[[164,1,2]]]);
//# sourceMappingURL=main.92d57276.chunk.js.map